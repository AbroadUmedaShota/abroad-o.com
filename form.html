<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>アブロードアウトソーシング株式会社 | お問い合わせフォーム</title>
    <meta name="description" content="アブロードアウトソーシング株式会社へのお問い合わせフォームです。データ入力、スキャニング、画像加工に関するご質問、お見積もりはこちらから。" />
    <meta name="google-site-verification" content="Nqa719cJbf2AfjLk6kCgmpJHM73egoAodcPCb-cdyyc" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-51168812-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-51168812-1');
    </script>
    <script>
      function loadComponent(elementId, componentPath) {
        fetch(componentPath)
          .then(response => response.text())
          .then(html => {
            document.getElementById(elementId).innerHTML = html;
          })
          .catch(error => console.error(`Error loading component ${componentPath}:`, error));
      }
    </script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/form.css">
    <link rel="canonical" href="https://www.abroad-o.com/form.html">
    <link rel="shortcut icon" href="/image/fabicon.png" >
    <link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">
</head>
<body>
    <header id="header-placeholder"></header>
    <script>
        loadComponent('header-placeholder', 'components/header.html');
    </script>

    <nav id="nav-placeholder"></nav>
    <script>
        loadComponent('nav-placeholder', 'components/nav.html');
    </script>

    <main>
        <section id="form-top">
            <div class="container">
                <!-- フォームヘッダー -->
                <h1 style="text-align: center;">お問い合わせ・お見積もりフォーム</h1>
                <!-- フォーム全体 -->
                <form action="https://docs.google.com/forms/d/e/1FAIpQLSducG_PN_pRRvNlEyEjI8RRUJbhFLKXPr--iopScCsDZhkZ9A/formResponse" method="post" id="contactForm" target="_self">
                    <!-- フォームテーブル -->
                   <div id="form-tbl" class="form-group">
                        <table id="form" class="table" style="width: 100%;">
                            <colgroup>
                                <col style="width: 30%;">
                                <col style="width: 70%;">
                            </colgroup>
                            <!-- フォーム入力項目 -->
                            <div class="form-group">
                                <label for="enterprise" class="must"><span class="badge badge-danger">必須</span> 企業名</label>
                                <input type="text" id="enterprise" name="entry.2325062" class="form-control" required pattern=".*\S.*" placeholder="例：アブロードアウトソーシング株式会社">
                            </div>

                            <div class="form-group">
                                <label for="department" class="nomust">部署・役職</label>
                                <input type="text" id="department" name="entry.1000001" class="form-control" pattern=".*\S.*">
                            </div>

                            <div class="form-group">
                                <label for="name" class="must"><span class="badge badge-danger">必須</span> お名前</label>
                                <input type="text" id="name" name="entry.1000002" class="form-control" required pattern=".*\S.*">
                            </div>

                            <div class="form-group">
                                <label for="email" class="must"><span class="badge badge-danger">必須</span> メールアドレス</label>
                                <input type="email" id="email" name="entry.1000003" class="form-control" required pattern="^[\w\.-]+@[\w\.-]+\.\w{2,}$" placeholder="例：info@abroad-o.com" title="正しいメールアドレスを入力してください。">
                                <span class="error-message">正しいメールアドレスを入力してください。</span>
                            </div>

                            <!-- ハニーポットフィールドの追加 -->
                            <div class="form-group honeypot">
                                <label for="honeypot_email">メールアドレス（入力しないでください）</label>
                                <input type="text" id="honeypot_email" name="entry.1234567890" class="form-control" tabindex="-1" autocomplete="off">
                            </div>

                            <div class="form-group">
                                <label for="phone" class="must"><span class="badge badge-danger">必須</span> 電話番号</label>
                                <input type="tel" id="phone" name="entry.1000004" class="form-control" required pattern="^(?:\+81|0)(?:\d{1,4})[-\s]?\d{1,4}[-\s]?\d{4}$" placeholder="例：03-5835-0250" title="電話番号の形式が正しくありません。例：03-5835-0250">
                                <span class="error-message" id="phone-error-message">電話番号の形式が正しくありません。例：03-5835-0250</span>
                            </div>

                            <div class="form-group">
                                <label for="address" class="nomust">住所</label>
                                <textarea id="address" name="entry.1000749928" class="form-control" placeholder="例：東京都千代田区2-1-8 秋葉原クロスサイド4階"></textarea>
                            </div>

                            <div class="form-group">
                                 <label for="inquiry_details" class="must"><span class="badge badge-danger">必須</span> お問い合わせ内容</label>
                                 <textarea id="inquiry_details" name="entry.1000005" class="form-control" required pattern=".*\S.*"></textarea>
                            </div>
                        </table>
                    </div>
                     <!-- 個人情報取り扱いに関する記述 -->
                     <div class="scroll-spy">
                        <p>「お問い合わせにおける個人情報の取扱いについて」</p>
                        <ul>
                            <li>（１）事業者の氏名または名称
                                <ul>
                                    <li>アブロードアウトソーシング株式会社</li>
                                </ul>
                            </li>
                            <li>（２）個人情報保護管理者（若しくはその代理人）の氏名又は職名、所属及び連絡先
                                <ul>
                                    <li>個人情報保護管理者：林 剛之</li>
                                    <li>電子メール：info@abroad-o.com</li>
                                    <li>電話番号：03-5835-0250</li>
                                </ul>
                            </li>
                            <li>（３）個人情報の利用目的
                                <ul>
                                    <li>お問い合わせいただいた内容に回答するため</li>
                                </ul>
                            </li>
                            <li>（４）個人情報の第三者提供について
                                <ul>
                                    <li>取得した個人情報は、法令等による場合を除いて第三者に提供することはありません。</li>
                                </ul>
                            </li>
                            <li>（５）個人情報の取扱いの委託について
                                <ul>
                                    <li>取得した個人情報の取扱いの全部または一部を委託することがあります。その場合には、当社において最善の考慮を行います。</li>
                                </ul>
                            </li>
                            <li>（６）個人情報を与えなかった場合に生じる結果
                                <ul>
                                    <li>個人情報の提供は任意です。しかし、一部の情報をご提供いただけない場合、お問い合わせ内容に回答できないことがあります。</li>
                                </ul>
                            </li>
                            <li>（７）保有個人データの開示等および問い合わせ窓口について
                                <ul>
                                    <li>ご本人からの求めに応じて、当社が保有する保有個人データに関する開示、利用目的の通知、内容の訂正・追加または削除、利用停止、消去および第三者提供の停止（以下、開示等という）に対応いたします。詳細は下記窓口までお問い合わせください。</li>
                                </ul>
                            </li>
                            <li>（８）本人が容易に認識できない方法による個人情報の取得
                                <ul>
                                    <li>クッキーやウェブビーコン等を用いた、本人が容易に認識できない方法による個人情報の取得は行っておりません。</li>
                                </ul>
                            </li>
                            <li>（９）個人情報の安全管理措置について
                                <ul>
                                    <li>取得した個人情報について、漏洩、減失または毀損の防止と是正を行うなど、適切な安全管理措置を講じます。</li>
                                    <li>お問い合わせへの回答後、取得した個人情報は当社内において削除いたします。</li>
                                </ul>
                            </li>
                            <li>（10）個人情報保護方針
                                <ul>
                                    <li>当社の個人情報保護方針は当社ホームページでご覧いただけます。</li>
                                </ul>
                            </li>
                             <li>（11）当社の個人情報の取扱いに関する苦情、相談等のお問い合わせ先
                                <table class="table_agree table table-bordered">
                                    <thead>
                                        <tr>
                                            <th scope="col">窓口の名称</th>
                                            <th scope="col">個人情報お問い合わせ窓口</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>連絡先</td>
                                            <td>
                                                <ul>
                                                    <li>窓口責任者：個人情報保護管理担当</li>
                                                    <li>住所：東京都千代田区東神田2-1-8　秋葉原クロスサイド4階</li>
                                                    <li>電話/FAX：03-5835-0250 / 03-3863-2570</li>
                                                    <li>電子メール：info@abroad-o.com</li>
                                                </ul>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </li>
                        </ul>
                    </div>

                     <!-- メッセージボックス -->
                    <div id="messageBox" class="message-box">個人情報の取扱について同意をお願いします。</div>
                    <!-- 同意チェックボックス -->
                    <div class="form-group consent-container">
                        <label for="consent">
                            <input type="checkbox" id="consent" name="entry.2027890221" required><span>個人情報の取扱について同意する。</span>
                        </label>
                    </div>
                    <!-- 送信ボタン -->
                    <div class="form-group mt-4 text-center">
                        <input type="submit" value="送信する" class="btn btn-primary btn-submit">
                    </div>
                    <!-- Google Formのhidden inputは送信に必要なので残す -->
                    <input type="hidden" name="fvv" value="1">
                    <input type="hidden" name="partialResponse" value="[null,null,"-1188643857103301952"]">
                    <input type="hidden" name="pageHistory" value="0">
                    <input type="hidden" name="fbzx" value="-1188643857103301952">

                </form>
                <!-- フォームフィードバックエリア -->
                <div id="form-feedback" class="mt-3" aria-live="polite"></div>
                 <!-- エラー時の問い合わせ先 -->
                 <p class="mt-4">※送信後エラー画面になる場合や2営業日経ってもご連絡がない場合は、お手数ではございますが、こちらのメールアドレス<a href="mailto:info@abroad-o.com?subject=お問い合わせフォームページより&body=【貴社名】%0D%0A【ご担当者様】%0D%0A【電話番号】%0D%0A【お問い合わせ内容】">info@abroad-o.com</a>でお問い合わせ下さい。</p>
            </div>
        </section>
    </main>
    <footer id="footer-placeholder"></footer>
    <script>
        loadComponent('footer-placeholder', 'components/footer.html');
    </script>
    <script src="https://kit.fontawesome.com/ac3b49c4bc.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <script>
        const form = document.getElementById('contactForm');
        const formFeedback = document.getElementById('form-feedback');
        const honeypotField = document.getElementById('honeypot_email'); // ハニーポットフィールドを取得

        // フォーム表示時刻を記録（ページロード時）
        const formLoadTime = Date.now();
        const MIN_SUBMISSION_TIME_MS = 3000; // 最低送信時間（ミリ秒、例: 3秒）

        form.addEventListener('submit', (event) => {
            event.preventDefault();

            // 1. ハニーポットチェック
            if (honeypotField.value !== '') {
                // ハニーポットフィールドに値が入力されている場合はボットと判断し、サイレントに処理を終了
                console.warn('Bot detected via honeypot.');
                formFeedback.textContent = 'エラーが発生しました。再度お試しいただくか、別の方法でご連絡ください。'; // ユーザーには一般的なエラーを表示
                formFeedback.style.color = 'red';
                return;
            }

            // 2. 時間ベースのチェック
            const submissionTime = Date.now();
            const elapsedTime = submissionTime - formLoadTime;

            if (elapsedTime < MIN_SUBMISSION_TIME_MS) {
                // 送信時間が短すぎる場合はボットと判断し、サイレントに処理を終了
                console.warn('Bot detected: Submission too fast.');
                formFeedback.textContent = 'エラーが発生しました。再度お試しいただくか、別の方法でご連絡ください。'; // ユーザーには一般的なエラーを表示
                formFeedback.style.color = 'red';
                return;
            }

            const consentCheckbox = document.getElementById('consent');
            if (!consentCheckbox.checked) {
                alert('個人情報の取扱について同意をお願いします。');
                return;
            }

            const submitButton = document.querySelector('.btn-submit');
            submitButton.disabled = true; // 送信ボタンを無効化

            const formData = new FormData(form);

            fetch(event.target.action, {
                method: 'POST',
                mode: 'no-cors',
                body: formData
            })
                .then(() => {
                    formFeedback.innerHTML = 'お問い合わせありがとうございます。<br>送信が完了しました。';
                    formFeedback.style.color = 'green';
                    // form.reset(); // フォームをリセットしない（または必要に応じて後でリセット）

                    // thanks.html へのリダイレクト
                    setTimeout(() => {
                        window.location.href = 'thank.html'; // ここを修正
                    }, 5000); // 5秒後にリダイレクト
                })
                .catch((error) => {
                    formFeedback.textContent = 'エラーが発生しました。再度お試しいただくか、別の方法でご連絡ください。';
                    formFeedback.style.color = 'red';
                    console.error('Error:', error);
                })
                .finally(() => {
                    submitButton.disabled = false; // finally で無効化を解除
                });
        });


        // smoothScroll (jQuery 不要)
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();

                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

    </script>
</body>
</html>
